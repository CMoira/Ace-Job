@page
@model AppSec_Assignment_2.Pages.RegisterModel
@{
}
<head runat="server">

	<!--  <script src="https://www.google.com/recaptcha/api.js?render=@ViewData["SiteKey"]"></script> -->

	<script type="text/javascript">
		
		function ValidatePassword() {
			var password = document.getElementById("Password").value;
			var confirmPassword = document.getElementById("ConfirmPassword").value;
			var errorSpan = document.getElementById("passwordError");
			var submitButton = document.querySelector("button[type='submit']");

			// Password requirements
			const minLength = 12;
			const hasLowercase = /[a-z]/.test(password);
			const hasUppercase = /[A-Z]/.test(password);
			const hasDigit = /[0-9]/.test(password);
			const hasSpecialChar = /[!@("@")#$%^&*]/.test(password);

			// Error messages
			let errorMessage = "";
			let errorMessage2 = "";

			if (password.length < minLength) {
				errorMessage = "Password must be at least 12 characters long!";
			} else if (!hasLowercase) {
				errorMessage = "Password must contain at least one lowercase letter.";
			} else if (!hasUppercase) {
				errorMessage = "Password must contain at least one uppercase letter.";
			} else if (!hasDigit) {
				errorMessage = "Password must contain at least one digit.";
			} else if (!hasSpecialChar) {
				errorMessage = "Password must contain at least one special character.";
			} else if (password !== confirmPassword) {
				errorMessage2 = "Passwords do not match!";
			}

			// Display error message and disable submit button if validation fails
			if (errorMessage) {
				errorSpan.textContent = errorMessage;
				submitButton.disabled = true;
				return false;
			} 
			else if (errorMessage2) {
				errorSpan.textContent = "";
				document.getElementById("confirmPasswordError").textContent = errorMessage2;
				submitButton.disabled = false;
				return true;
			}
			else {
				errorSpan.textContent = "";
				document.getElementById("confirmPasswordError").textContent = "";
				submitButton.disabled = false;
				return true;
			}
		}

	</script>
</head>

<div class="container mt-5">
	<div class="row justify-content-center align-items-center">
		<div class="col-sm-12 col-md-12 col-lg-4">
			<h1 class="mb-3">Register</h1>

			<form method = "post" >
				@Html.AntiForgeryToken()
				<div asp-validation-summary="All" class="text-danger"></div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.FirstName">First Name</label>
					<input type = "Text" asp-for="RModel.FirstName" class="form-control" />
					<span asp-validaton-for="RModel.FirstName" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.LastName">Last Name</label>
					<input type = "Text" asp-for="RModel.LastName" class="form-control" />
					<span asp-validaton-for="RModel.LastName" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.Gender">Gender</label>
					<div>
						<input type="radio" asp-for="RModel.Gender" value="Male" />
						<label for="Gender">Male</label>
					</div>
					<div>
						<input type="radio" asp-for="RModel.Gender" value="Female" />
						<label for="Gender">Female</label>
					</div>
					<div>
						<input type="radio" asp-for="RModel.Gender" value="Rather not Say" />
						<label for="Gender">Other</label>
					</div>
					<span asp-validaton-for="RModel.Gender" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.DateOfBirth">Date of Birth</label>
					<input type = "Date" asp-for="RModel.DateOfBirth" class="form-control" />
					<span asp-validaton-for="RModel.DateOfBirth" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.NRIC">NRIC</label>
					<input type = "Text" asp-for="RModel.NRIC" class="form-control" />
					<span asp-validaton-for="RModel.NRIC" class="text-danger"></span>
				</div>


				<div class="mb-3">
					<label class="form-label" asp-for="RModel.EmailAddress">Email Address</label>
					<input type = "Text" asp-for="RModel.EmailAddress" class="form-control" />
					<span asp-validaton-for="RModel.Email" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.Resume">Resume</label>
					<input type = "file" asp-for="RModel.Resume" class="form-control" />
					<span asp-validaton-for="RModel.Resume" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.WhoAmI">Who Am I</label>
					<input type = "Text" asp-for="RModel.WhoAmI" class="form-control" />
					<span asp-validaton-for="RModel.WhoAmI" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.Password">Password</label>
					<input type="password" id="Password" asp-for="RModel.Password" class="form-control" onkeyup="ValidatePassword();" />
					<span asp-validaton-for="RModel.Password" class="text-danger"></span>
					<span id="passwordError" class="text-danger"></span>
				</div>

				<div class="mb-3">
					<label class="form-label" asp-for="RModel.ConfirmPassword">Confirm Password</label>
					<input type="password" id="ConfirmPassword" asp-for="RModel.ConfirmPassword" class="form-control" onkeyup="ValidatePassword();" />
					<span asp-validaton-for="RModel.ConfirmPassword" class="text-danger"></span>
					<span id="confirmPasswordError" class="text-danger"></span>
				</div>

				<!--  <input type="hidden" id="g-recaptcha-register-response" name="g-recaptcha-register-response" /> -->

				<div class="mb-3">
					<button type = "submit" class="btn btn-primary">Register</button>
				</div>
			</form>
		</div>
	</div>
</div>

<!-- 
<script>
	grecaptcha.ready(function () {
		grecaptcha.execute('@ViewData["SiteKey"]', { action: 'Register' }).then(function (token) {
			document.getElementById("g-recaptcha-register-response").value = token;
		});
	});
</script> 
-->